---
title: File Upload
description: A composable, accessible file upload component with drag-and-drop, validation, and progress support.
icon: Upload
---

import { FileUpload, formatFileSize } from '@px-ui/core';
import { ComponentPreview } from '../../../src/components/component-preview';

## Overview

The FileUpload component provides a flexible, composable API for building file upload experiences. It supports drag-and-drop, paste, file validation, progress tracking, and various layouts including file lists and image grids.

Built following the compound component pattern (similar to [coss.com/origin/file-upload](https://coss.com/origin/file-upload)), you can mix and match parts to create custom upload UIs.

## Installation

```bash
npm install @px-ui/core
```

## Import

```tsx
import { FileUpload, formatFileSize } from '@px-ui/core';
```

## Basic Usage

### Simple Dropzone

<ComponentPreview>
  <FileUpload.Root onValueChange={(files) => console.log(files)}>
    <FileUpload.Dropzone />
  </FileUpload.Root>
</ComponentPreview>

```tsx
<FileUpload.Root onValueChange={(files) => console.log(files)}>
  <FileUpload.Dropzone />
</FileUpload.Root>
```

### With File List

<ComponentPreview>
  <FileUpload.Root multiple onValueChange={(files) => console.log(files)}>
    <FileUpload.Dropzone />
    <FileUpload.ItemList>
      {(files) =>
        files.map((file) => (
          <FileUpload.Item key={file.id} file={file}>
            <FileUpload.ItemPreview />
            <div className="flex min-w-0 flex-col">
              <FileUpload.ItemName />
              <FileUpload.ItemSize />
            </div>
            <FileUpload.ItemRemove />
          </FileUpload.Item>
        ))
      }
    </FileUpload.ItemList>
  </FileUpload.Root>
</ComponentPreview>

```tsx
<FileUpload.Root multiple onValueChange={(files) => console.log(files)}>
  <FileUpload.Dropzone />
  <FileUpload.ItemList>
    {(files) =>
      files.map((file) => (
        <FileUpload.Item key={file.id} file={file}>
          <FileUpload.ItemPreview />
          <div className="flex min-w-0 flex-col">
            <FileUpload.ItemName />
            <FileUpload.ItemSize />
          </div>
          <FileUpload.ItemRemove />
        </FileUpload.Item>
      ))
    }
  </FileUpload.ItemList>
</FileUpload.Root>
```

## Component Parts

The FileUpload component is composed of multiple parts that can be combined:

| Component | Description |
|-----------|-------------|
| `FileUpload.Root` | Context provider, manages state and validation |
| `FileUpload.Dropzone` | Drag-and-drop area with default UI |
| `FileUpload.Trigger` | Standalone button to open file picker |
| `FileUpload.ItemList` | Container for file items |
| `FileUpload.Item` | Individual file item wrapper |
| `FileUpload.ItemPreview` | Thumbnail/preview for files |
| `FileUpload.ItemName` | File name display |
| `FileUpload.ItemSize` | File size display |
| `FileUpload.ItemRemove` | Remove file button |
| `FileUpload.ItemProgress` | Progress bar for uploads |
| `FileUpload.ClearButton` | Remove all files button |
| `FileUpload.ImageGrid` | Grid layout for images |
| `FileUpload.ImageGridItem` | Image grid item with remove |

## Image Upload with Grid

<ComponentPreview>
  <FileUpload.Root 
    multiple 
    accept="image/*" 
    maxFiles={8}
    onValueChange={(files) => console.log(files)}
  >
    <FileUpload.Dropzone 
      dropzoneText="Drop your images here" 
      browseText="Select Images" 
      size="sm"
    />
    <FileUpload.ImageGrid className="grid-cols-4">
      {(files) =>
        files.map((file) => (
          <FileUpload.ImageGridItem key={file.id} file={file} />
        ))
      }
    </FileUpload.ImageGrid>
  </FileUpload.Root>
</ComponentPreview>

```tsx
<FileUpload.Root multiple accept="image/*" maxFiles={8}>
  <FileUpload.Dropzone 
    dropzoneText="Drop your images here" 
    browseText="Select Images"
  />
  <FileUpload.ImageGrid>
    {(files) =>
      files.map((file) => (
        <FileUpload.ImageGridItem key={file.id} file={file} />
      ))
    }
  </FileUpload.ImageGrid>
</FileUpload.Root>
```

## File Upload with Progress

```tsx
import { FileUpload, useFileUpload } from '@px-ui/core';

function UploadWithProgress() {
  const [files, setFiles] = React.useState([]);
  
  const handleUpload = async (newFiles) => {
    setFiles(newFiles);
    
    // Simulate upload progress
    for (const file of newFiles) {
      for (let progress = 0; progress <= 100; progress += 10) {
        await new Promise(r => setTimeout(r, 100));
        setFiles(prev => 
          prev.map(f => f.id === file.id ? { ...f, progress } : f)
        );
      }
    }
  };

  return (
    <FileUpload.Root 
      value={files} 
      onValueChange={handleUpload}
      multiple
    >
      <FileUpload.Dropzone />
      <FileUpload.ItemList>
        {(files) =>
          files.map((file) => (
            <FileUpload.Item key={file.id} file={file}>
              <FileUpload.ItemPreview />
              <div className="flex min-w-0 flex-1 flex-col gap-1">
                <FileUpload.ItemName />
                <FileUpload.ItemProgress />
              </div>
              <FileUpload.ItemRemove />
            </FileUpload.Item>
          ))
        }
      </FileUpload.ItemList>
    </FileUpload.Root>
  );
}
```

## Custom Dropzone Content

You can fully customize the dropzone content:

```tsx
<FileUpload.Root>
  <FileUpload.Dropzone hideDefaultContent>
    <div className="text-center">
      <UploadIcon className="mx-auto size-12 text-ppx-neutral-8" />
      <p className="mt-2 text-ppx-sm text-ppx-neutral-12">
        Drag & drop or click to browse
      </p>
      <p className="text-ppx-xs text-ppx-neutral-10">
        Max 10MB â€¢ PNG, JPG, PDF
      </p>
    </div>
  </FileUpload.Dropzone>
</FileUpload.Root>
```

## Trigger Button Only

Use just a button without a dropzone:

```tsx
<FileUpload.Root accept="image/*">
  <FileUpload.Trigger variant="primary">
    Upload Image
  </FileUpload.Trigger>
  <FileUpload.ItemList>
    {(files) =>
      files.map((file) => (
        <FileUpload.Item key={file.id} file={file}>
          <FileUpload.ItemPreview />
          <FileUpload.ItemName />
          <FileUpload.ItemRemove />
        </FileUpload.Item>
      ))
    }
  </FileUpload.ItemList>
</FileUpload.Root>
```

## Validation

### File Type Restriction

```tsx
<FileUpload.Root 
  accept="image/*,.pdf"
  onError={(error) => console.error(error.message)}
>
  <FileUpload.Dropzone />
</FileUpload.Root>
```

### File Size Limit

```tsx
<FileUpload.Root 
  maxSize={5 * 1024 * 1024} // 5MB
  onError={(error) => console.error(error.message)}
>
  <FileUpload.Dropzone />
</FileUpload.Root>
```

### Max Files Limit

```tsx
<FileUpload.Root 
  multiple 
  maxFiles={5}
  onError={(error) => console.error(error.message)}
>
  <FileUpload.Dropzone />
</FileUpload.Root>
```

## Controlled Mode

Control the files state externally:

```tsx
function ControlledUpload() {
  const [files, setFiles] = React.useState([]);

  return (
    <FileUpload.Root value={files} onValueChange={setFiles}>
      <FileUpload.Dropzone />
      <FileUpload.ItemList>
        {(files) => files.map((file) => (
          <FileUpload.Item key={file.id} file={file}>
            <FileUpload.ItemName />
            <FileUpload.ItemRemove />
          </FileUpload.Item>
        ))}
      </FileUpload.ItemList>
      <FileUpload.ClearButton />
    </FileUpload.Root>
  );
}
```

## Using the Hook

Access the file upload context with `useFileUpload`:

```tsx
import { FileUpload, useFileUpload } from '@px-ui/core';

function CustomUploadButton() {
  const { openFilePicker, files, disabled } = useFileUpload();
  
  return (
    <button onClick={openFilePicker} disabled={disabled}>
      {files.length > 0 ? `${files.length} files selected` : 'Select files'}
    </button>
  );
}

// Usage
<FileUpload.Root>
  <CustomUploadButton />
</FileUpload.Root>
```

## API Reference

### FileUpload.Root

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `value` | `FileUploadFile[]` | - | Controlled files state |
| `defaultValue` | `FileUploadFile[]` | `[]` | Default files (uncontrolled) |
| `onValueChange` | `(files: FileUploadFile[]) => void` | - | Called when files change |
| `accept` | `string` | - | Accepted file types |
| `multiple` | `boolean` | `false` | Allow multiple files |
| `maxSize` | `number` | - | Max file size in bytes |
| `maxFiles` | `number` | - | Max number of files |
| `disabled` | `boolean` | `false` | Disable the upload |
| `onError` | `(error: FileUploadError) => void` | - | Validation error callback |

### FileUpload.Dropzone

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `size` | `'sm' \| 'default' \| 'lg'` | `'default'` | Dropzone size |
| `dropzoneText` | `string` | `'Paste Or Drag & Drop Files Here'` | Dropzone text |
| `browseText` | `string` | `'Browse for files'` | Browse button text |
| `hideDefaultContent` | `boolean` | `false` | Hide default content |

### FileUploadFile Type

```tsx
interface FileUploadFile {
  id: string;
  file: File;
  progress?: number;
  status?: 'idle' | 'uploading' | 'success' | 'error';
  preview?: string; // Auto-generated for images
}
```

### FileUploadError Type

```tsx
interface FileUploadError {
  type: 'file-too-large' | 'too-many-files' | 'invalid-type';
  message: string;
  files?: File[];
}
```

## Accessibility

- Keyboard navigation with Enter/Space to open file picker
- `aria-live` announcements for file selections and errors
- Proper ARIA attributes on all interactive elements
- Focus management and visible focus indicators
- Screen reader instructions for usage

## Best Practices

- **Provide clear constraints**: Display accepted types and size limits
- **Show progress**: Use `ItemProgress` for upload feedback
- **Handle errors**: Implement `onError` for user-friendly messages
- **Preview images**: The component auto-generates previews for images
- **Clean up**: Previews are automatically cleaned up on unmount
